<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Report - SmartRecruit</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Flatpickr Datepicker CSS & JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body class="bg-gray-100 font-sans text-gray-800">

    <div class="max-w-7xl mx-auto p-6">

        <!-- Header -->
        <header class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-semibold">Reports</h1>
            <div class="flex">
                <a href="40-Admin Panel Home.html"
                    class="flex items-center bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition mr-2">
                    Home
                </a>
                <button id="exportBtn"
                    class="flex items-center bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition">
                    <!-- Simple Export Icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Export Report
                </button>
            </div>
        </header>

        <!-- Filters -->
        <section class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-semibold mb-4">Report Filters</h2>
            <div class="flex flex-wrap gap-6">

                <div class="flex flex-col flex-1 min-w-[180px]">
                    <label for="from-date" class="mb-1 text-gray-600 font-medium">From Date</label>
                    <input type="text" id="from-date" placeholder="mm/dd/yyyy"
                        class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                </div>

                <div class="flex flex-col flex-1 min-w-[180px]">
                    <label for="to-date" class="mb-1 text-gray-600 font-medium">To Date</label>
                    <input type="text" id="to-date" placeholder="mm/dd/yyyy"
                        class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                </div>

                <div class="flex flex-col flex-1 min-w-[180px]">
                    <label for="report-type" class="mb-1 text-gray-600 font-medium">Report Type</label>
                    <select id="report-type"
                        class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>User Reports</option>
                        <option>Job Reports</option>
                        <option>Recruiter Reports</option>
                    </select>
                </div>

                <div class="flex items-end">
                    <button id="filterBtn"
                        class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                        Filter Results
                    </button>
                    <button id="resetBtn"
                        class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition ml-2">
                        Reset Filters
                    </button>
                </div>
            </div>
        </section>

        <!-- Charts -->
        <section class="flex flex-col lg:flex-row gap-6 mb-6">

            <!-- Daily Job Posts -->
            <div class="bg-white rounded-lg shadow p-6 flex-1">
                <h3 class="text-lg font-semibold mb-4">Daily Job Posts</h3>
                <canvas id="dailyJobPostsChart" height="250"></canvas>
            </div>

            <!-- Recruiters vs Jobseekers -->
            <div class="bg-white rounded-lg shadow p-6 flex-1">
                <h3 class="text-lg font-semibold mb-4">Recruiters vs Jobseekers</h3>
                <canvas id="recruitersVsJobseekersChart" height="250"></canvas>
            </div>

            <!-- Job Status Distribution -->
            <div class="bg-white rounded-lg shadow p-6 flex-1">
                <h3 class="text-lg font-semibold mb-4">Job Status Distribution</h3>
                <canvas id="jobStatusDistributionChart" height="250"></canvas>
            </div>
        </section>

        <!-- Detailed Report Table -->
        <section class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-xl font-semibold mb-4">Detailed Report</h2>
            <div class="overflow-x-auto scrollbar-thin scrollbar-thumb-blue-300 scrollbar-track-gray-100">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="p-3 border-b border-gray-300">ID</th>
                            <th class="p-3 border-b border-gray-300">User/Job Name</th>
                            <th class="p-3 border-b border-gray-300">Date</th>
                            <th class="p-3 border-b border-gray-300">Action Taken</th>
                            <th class="p-3 border-b border-gray-300">Status</th>
                            <th class="p-3 border-b border-gray-300">Remarks</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody">
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12345</td>
                            <td class="p-3 border-b border-gray-300">John Developer</td>
                            <td class="p-3 border-b border-gray-300">Jan 15, 2025</td>
                            <td class="p-3 border-b border-gray-300">Application Submitted</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-green-200 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Approved</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Qualified candidate</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12346</td>
                            <td class="p-3 border-b border-gray-300">Sarah Designer</td>
                            <td class="p-3 border-b border-gray-300">Jan 16, 2025</td>
                            <td class="p-3 border-b border-gray-300">Interview Scheduled</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-yellow-200 text-yellow-800 px-3 py-1 rounded-full text-xs font-semibold">Pending</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Awaiting interview</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12347</td>
                            <td class="p-3 border-b border-gray-300">Mike Manager</td>
                            <td class="p-3 border-b border-gray-300">Jan 17, 2025</td>
                            <td class="p-3 border-b border-gray-300">Offer Extended</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-blue-200 text-blue-800 px-3 py-1 rounded-full text-xs font-semibold">Negotiating</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Negotiating salary</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12348</td>
                            <td class="p-3 border-b border-gray-300">Emily Analyst</td>
                            <td class="p-3 border-b border-gray-300">Jan 18, 2025</td>
                            <td class="p-3 border-b border-gray-300">Background Check</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-green-200 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Approved</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Background check passed</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12349</td>
                            <td class="p-3 border-b border-gray-300">David Architect</td>
                            <td class="p-3 border-b border-gray-300">Jan 19, 2025</td>
                            <td class="p-3 border-b border-gray-300">Final Interview</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-yellow-200 text-yellow-800 px-3 py-1 rounded-full text-xs font-semibold">Pending</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Awaiting feedback</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12350</td>
                            <td class="p-3 border-b border-gray-300">Linda Accountant</td>
                            <td class="p-3 border-b border-gray-300">Jan 20, 2025</td>
                            <td class="p-3 border-b border-gray-300">Skills Assessment</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-red-200 text-red-800 px-3 py-1 rounded-full text-xs font-semibold">Rejected</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Did not meet requirements</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12351</td>
                            <td class="p-3 border-b border-gray-300">Kevin Consultant</td>
                            <td class="p-3 border-b border-gray-300">Jan 21, 2025</td>
                            <td class="p-3 border-b border-gray-300">Reference Checks</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-green-200 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Approved</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">References verified</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12352</td>
                            <td class="p-3 border-b border-gray-300">Ashley Coordinator</td>
                            <td class="p-3 border-b border-gray-300">Jan 22, 2025</td>
                            <td class="p-3 border-b border-gray-300">Initial Screening</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-yellow-200 text-yellow-800 px-3 py-1 rounded-full text-xs font-semibold">Pending</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Scheduling interview</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12353</td>
                            <td class="p-3 border-b border-gray-300">Brian Engineer</td>
                            <td class="p-3 border-b border-gray-300">Jan 23, 2025</td>
                            <td class="p-3 border-b border-gray-300">Technical Interview</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-green-200 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Approved</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Technical skills strong</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12354</td>
                            <td class="p-3 border-b border-gray-300">Nicole Designer</td>
                            <td class="p-3 border-b border-gray-300">Jan 24, 2025</td>
                            <td class="p-3 border-b border-gray-300">Portfolio Review</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-green-200 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Approved</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Portfolio impressive</td>
                        </tr>
                        <tr>
                            <td class="p-3 border-b border-gray-300">#12355</td>
                            <td class="p-3 border-b border-gray-300">Adam Developer</td>
                            <td class="p-3 border-b border-gray-300">Jan 25, 2025</td>
                            <td class="p-3 border-b border-gray-300">Code Challenge</td>
                            <td class="p-3 border-b border-gray-300">
                                <span
                                    class="inline-block bg-red-200 text-red-800 px-3 py-1 rounded-full text-xs font-semibold">Rejected</span>
                            </td>
                            <td class="p-3 border-b border-gray-300">Code challenge failed</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="flex justify-end gap-3 mt-4" aria-label="Pagination Navigation">
                <button id="prevPage" class="border border-gray-300 px-3 py-1 rounded hover:bg-gray-200">
                    Previous
                </button>
                <button class="border border-gray-300 px-3 py-1 rounded bg-blue-600 text-white">
                    1
                </button>
                <button class="border border-gray-300 px-3 py-1 rounded hover:bg-gray-200">
                    2
                </button>
                <button class="border border-gray-300 px-3 py-1 rounded hover:bg-gray-200">
                    3
                </button>
                <button id="nextPage" class="border border-gray-300 px-3 py-1 rounded hover:bg-gray-200">
                    Next
                </button>
            </div>
        </section>
    </div>

    <!-- JS Script -->
    <script>
        // Initialize flatpickr date pickers
        flatpickr("#from-date", {
            dateFormat: "m/d/Y"
        });
        flatpickr("#to-date", {
            dateFormat: "m/d/Y"
        });

        // Chart instances
        const dailyJobPostsCtx = document.getElementById("dailyJobPostsChart").getContext("2d");
        const recruitersVsJobseekersCtx = document.getElementById("recruitersVsJobseekersChart").getContext("2d");
        const jobStatusDistributionCtx = document.getElementById("jobStatusDistributionChart").getContext("2d");

        // Initial Chart Data
        const dailyJobPostsChart = new Chart(dailyJobPostsCtx, {
            type: "bar",
            data: {
                labels: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                datasets: [{
                    label: "Job Posts",
                    data: [10, 12, 14, 8, 18, 20, 16],
                    backgroundColor: "#2563EB",
                    borderRadius: 4,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: true
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        const recruitersVsJobseekersChart = new Chart(recruitersVsJobseekersCtx, {
            type: "doughnut",
            data: {
                labels: ["Recruiters", "Jobseekers"],
                datasets: [{
                    data: [140, 360],
                    backgroundColor: ["#2563EB", "#F97316"]
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: "bottom"
                    },
                    tooltip: {
                        enabled: true
                    }
                }
            }
        });

        const jobStatusDistributionChart = new Chart(jobStatusDistributionCtx, {
            type: "pie",
            data: {
                labels: ["Open", "Closed", "Pending"],
                datasets: [{
                    data: [120, 80, 50],
                    backgroundColor: ["#10B981", "#EF4444", "#FBBF24"]
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: "bottom"
                    },
                    tooltip: {
                        enabled: true
                    }
                }
            }
        });

        // Function to simulate API fetch based on filter
        function fetchReportData(fromDate, toDate, reportType) {
            // Normally you'd fetch from server, but here we simulate data change
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simulate different data based on report type
                    let data = {};
                    if (reportType === "User Reports") {
                        data = {
                            dailyJobPosts: [5, 8, 15, 12, 20, 25, 30],
                            recruitersVsJobseekers: [140, 360],
                            jobStatusDistribution: [100, 60, 40],
                            tableRows: [
                                ["#12345", "John Developer", "Jan 15, 2025", "Application Submitted", "Approved",
                                    "Qualified candidate"
                                ],
                                ["#12346", "Sarah Designer", "Jan 16, 2025", "Interview Scheduled", "Pending",
                                    "Awaiting interview"
                                ],
                                ["#12347", "Mike Manager", "Jan 17, 2025", "Offer Extended", "Negotiating",
                                    "Negotiating salary"
                                ],
                                ["#12348", "Emily Analyst", "Jan 18, 2025", "Background Check", "Approved",
                                    "Background check passed"
                                ],
                                ["#12349", "David Architect", "Jan 19, 2025", "Final Interview", "Pending",
                                    "Awaiting feedback"
                                ],
                                ["#12350", "Linda Accountant", "Jan 20, 2025", "Skills Assessment", "Rejected",
                                    "Did not meet requirements"
                                ],
                                ["#12351", "Kevin Consultant", "Jan 21, 2025", "Reference Checks", "Approved",
                                    "References verified"
                                ],
                                ["#12352", "Ashley Coordinator", "Jan 22, 2025", "Initial Screening", "Pending",
                                    "Scheduling interview"
                                ],
                                ["#12353", "Brian Engineer", "Jan 23, 2025", "Technical Interview", "Approved",
                                    "Technical skills strong"
                                ],
                                ["#12354", "Nicole Designer", "Jan 24, 2025", "Portfolio Review", "Approved",
                                    "Portfolio impressive"
                                ],
                                ["#12355", "Adam Developer", "Jan 25, 2025", "Code Challenge", "Rejected",
                                    "Code challenge failed"
                                ],
                            ]
                        };
                    } else if (reportType === "Job Reports") {
                        data = {
                            dailyJobPosts: [7, 9, 12, 14, 18, 21, 24],
                            recruitersVsJobseekers: [100, 400],
                            jobStatusDistribution: [80, 100, 60],
                            tableRows: [
                                ["#23456", "Job A", "Feb 20, 2025", "Posted", "Open", "Looking for candidates"],
                                ["#23457", "Job B", "Feb 22, 2025", "Closed", "Closed", "Filled position"],
                                ["#23458", "Job C", "Feb 24, 2025", "Posted", "Open", "Urgently hiring"],
                                ["#23459", "Job D", "Feb 26, 2025", "Interviewing", "Pending", "Scheduling interviews"],
                                ["#23460", "Job E", "Feb 28, 2025", "Offer", "Pending", "Preparing offer letter"],
                                ["#23461", "Job F", "Mar 02, 2025", "Closed", "Closed", "Successful hire"],
                                ["#23462", "Job G", "Mar 04, 2025", "Posted", "Open", "Competitive salary"],
                                ["#23463", "Job H", "Mar 06, 2025", "Screening", "Pending", "Reviewing applications"],
                                ["#23464", "Job I", "Mar 08, 2025", "Interviewing", "Pending", "Second round interviews"],
                                ["#23465", "Job J", "Mar 10, 2025", "Offer", "Pending", "Negotiating terms"],
                                ["#23466", "Job K", "Mar 12, 2025", "Closed", "Closed", "Position filled internally"],
                            ]
                        };
                    } else { // Recruiter Reports
                        data = {
                            dailyJobPosts: [3, 6, 10, 8, 12, 15, 18],
                            recruitersVsJobseekers: [200, 300],
                            jobStatusDistribution: [90, 70, 30],
                            tableRows: [
                                ["#34567", "Recruiter X", "Mar 01, 2025", "Hired", "Active", "Good performance"],
                                ["#34568", "Recruiter Y", "Mar 05, 2025", "Sourced", "Active", "Needs improvement"],
                                ["#34569", "Recruiter Z", "Mar 09, 2025", "Interviewed", "Active", "High volume"],
                                ["#34570", "Recruiter A", "Mar 13, 2025", "Offered", "Active", "Excellent communication"],
                                ["#34571", "Recruiter B", "Mar 17, 2025", "Placed", "Active", "Strong network"],
                                ["#34572", "Recruiter C", "Mar 21, 2025", "Screened", "Active", "Efficient process"],
                                ["#34573", "Recruiter D", "Mar 25, 2025", "Submitted", "Active", "Quality candidates"],
                                ["#34574", "Recruiter E", "Mar 29, 2025", "Contacted", "Active", "Proactive approach"],
                                ["#34575", "Recruiter F", "Apr 02, 2025", "Researched", "Active", "Market knowledge"],
                                ["#34576", "Recruiter G", "Apr 06, 2025", "Negotiated", "Active", "Successful closures"],
                                ["#34577", "Recruiter H", "Apr 10, 2025", "Closed", "Active", "Consistent results"],
                            ]
                        };
                    }
                    resolve(data);
                }, 500);
            });
        }

        // Function to update the table headers dynamically
        function updateTableHeaders(reportType) {
            // Get the table element
            const table = document.querySelector("table");
            // Get the table header row
            const theadRow = table.querySelector("thead tr");
            // Clear existing headers
            theadRow.innerHTML = "";

            // Define headers based on report type
            let headers = [];
            if (reportType === "User Reports") {
                headers = ["ID", "User Name", "Date", "Action Taken", "Status", "Remarks"];
            } else if (reportType === "Job Reports") {
                headers = ["ID", "Job Name", "Date", "Action Taken", "Status", "Description"];
            } else { // Recruiter Reports
                headers = ["ID", "Recruiter Name", "Date", "Action Taken", "Status", "Performance"];
            }

            // Create table header elements
            headers.forEach(headerText => {
                const th = document.createElement("th");
                th.className = "p-3 border-b border-gray-300";
                th.textContent = headerText;
                theadRow.appendChild(th);
            });
        }

        // Update charts and table with new data
        async function updateReport() {
            // Get filter values
            const fromDate = document.getElementById("from-date").value;
            const toDate = document.getElementById("to-date").value;
            const reportType = document.getElementById("report-type").value;

            // Validate dates
            if (new Date(fromDate) > new Date(toDate)) {
                alert("From Date cannot be greater than To Date");
                return;
            }

            // Show loading state (optional)
            const loadingMessage = document.createElement("p");
            loadingMessage.textContent = "Loading data...";
            const reportSection = document.querySelector(".overflow-x-auto"); // Or another appropriate container
            reportSection.appendChild(loadingMessage);

            try {
                // Fetch data
                const data = await fetchReportData(fromDate, toDate, reportType);

                // Update Daily Job Posts Chart
                dailyJobPostsChart.data.datasets[0].data = data.dailyJobPosts;
                dailyJobPostsChart.update();

                // Update Recruiters vs Jobseekers Chart
                recruitersVsJobseekersChart.data.datasets[0].data = data.recruitersVsJobseekers;
                recruitersVsJobseekersChart.update();

                // Update Job Status Distribution Chart
                jobStatusDistributionChart.data.datasets[0].data = data.jobStatusDistribution;
                jobStatusDistributionChart.update();

                // Update Table Headers
                updateTableHeaders(reportType);

                // Update Table
                const tbody = document.getElementById("reportTableBody");
                tbody.innerHTML = ""; // Clear old rows

                data.tableRows.forEach((row) => {
                    const tr = document.createElement("tr");

                    row.forEach((cell, index) => {
                        const td = document.createElement("td");
                        td.className = "p-3 border-b border-gray-300";

                        if (index === 4) {
                            // Status with colored badge
                            let colorClass = "bg-gray-200 text-gray-700";
                            if (cell.toLowerCase() === "approved" || cell.toLowerCase() === "active" || cell
                                .toLowerCase() === "open") {
                                colorClass = "bg-green-200 text-green-800";
                            } else if (cell.toLowerCase() === "pending") {
                                colorClass = "bg-yellow-200 text-yellow-800";
                            } else if (cell.toLowerCase() === "closed") {
                                colorClass = "bg-red-200 text-red-800";
                            }
                            const span = document.createElement("span");
                            span.className =
                                `inline-block px-3 py-1 rounded-full text-xs font-semibold ${colorClass}`;
                            span.textContent = cell;
                            td.appendChild(span);
                        } else {
                            td.textContent = cell;
                        }
                        tr.appendChild(td);
                    });

                    tbody.appendChild(tr);
                });
            } catch (error) {
                console.error("Error updating report:", error);
                alert("Failed to update report. See console for details.");
            } finally {
                // Remove loading message
                reportSection.removeChild(loadingMessage);
            }
        }

        // Function to export table data to CSV
        function exportTableToCSV() {
            try {
                // Get the table element
                const table = document.getElementById("reportTableBody");
                if (!table) {
                    throw new Error("Table not found");
                }

                // Get all rows from the table
                const rows = Array.from(table.querySelectorAll("tr"));

                // Check if there is data to export
                if (!rows.length) {
                    throw new Error("No data to export");
                }

                // Get headers
                const headers = Array.from(document.querySelectorAll("th")).map(header => header.textContent);

                // Convert rows to CSV format
                const csv = [
                    headers.join(","), // Add headers to CSV
                    ...rows.map(row =>
                        Array.from(row.querySelectorAll("td"))
                        .map(cell => cell.textContent)
                        .join(",")
                    )
                ].join("\n");

                // Create a download link
                const link = document.createElement("a");
                link.setAttribute("href", "data:text/csv;charset=utf-8," + encodeURIComponent(csv));
                link.setAttribute("download", "report.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                alert("Error exporting report: " + error.message);
            }
        }

        // Function to reset filters
        function resetFilters() {
            document.getElementById("from-date").value = "";
            document.getElementById("to-date").value = "";
            document.getElementById("report-type").selectedIndex = 0; // Reset to the first option
            updateReport(); // Refresh the report with default settings
        }

        // Event listeners
        document.getElementById("filterBtn").addEventListener("click", updateReport);
        document.getElementById("exportBtn").addEventListener("click", exportTableToCSV);
        document.getElementById("resetBtn").addEventListener("click", resetFilters);

        // Initial load
        updateReport();
    </script>
</body>

</html>
